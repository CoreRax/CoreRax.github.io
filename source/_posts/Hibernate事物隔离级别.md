title: Hibernate事物的隔离级别
---
### 数据库事务的定义  
数据库事务是指作为单个逻辑工作单元执行的一系列操作。事务处理可以确保除非事务性单元外的所有操作都成功，否则不会永久更新面向数据的资源。通过将一组相关操作组合为一个要么全部成功，要么全部失败的单元，可以简化错误恢复并使应用程序更加可靠。  

一个逻辑工作单元要成为事务，必须满足ACID：
A：atomic，原子性，事务必须是原子工作单元，对于其数据修改要么全部成功，要么全部失败。  
C:consistent,一致性，事务在完成时，所有的的数据都保持一致的状态。  
I:isolation,隔离性，由并发事务所做的修改必须与其他任何并发事务所做的修改隔离。  
D：Duration，持久性，事物完成后对于系统的影响是永久的。


### 数据库并发事务可能带来的问题  
**丢失更新**  
在没有完全隔离事务的情况下，两个事务更新同一条数据，某一事务异常终止，回滚导致第一个更新也同时丢失。  
**脏读**  
如果第二个事务查询到的是第一个事务还没有提交的数据，但是第一个事务最后回滚了。导致第一个事务读取的是脏数据。  
**虚读**  
一个事务执行两次查询，第二次查询中包含了第一次查询中没有的行或者已经删除的行，造成两次结果不一致。这是另一个事务在这两次查询中间插入或者删除造成的。  
**不可重复读**  
一个事物两次读取同一行数据，结果得到不同状态结果，如中间正好另一个事务更新了该数据，两次结果相异，不可信任。  
**第二类丢失更新**  
是不可重复读的特殊情况，如果两个事务都读取同一行，然后两个都进行写操作，并且提交，第一个事务的改变就消失。  


### 数据库的事务隔离级别  
为了解决数据库事务并发运行时的各种问题，数据库系统提供了四种事务隔离级别：
1.Serializable 串行化  
2.Repeatable 可重复读  
3.Read Commited 可读已提交  
4.read Uncommited 可读未提交  

### 使用Hibernate设置数据库隔离级别

在Hibernate的配置文件中可以显示的配置数据库事务隔离级别。每一个隔离级别用一个整数表示：

8 - Serializable 串行化
4 - Repeatable Read 可重复读
2 - Read Commited 可读已提交
1 - Read Uncommited 可读未提交

在hibernate.cfg.xml中使用hibernate.connection.isolation参数配置数据库事务隔离级别。